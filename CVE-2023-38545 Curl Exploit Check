// Dirty KQL query to check for exploitation of curl, CVE-2023-38545
DeviceNetworkEvents
| where RemotePort == 9050 or RemotePort == 1080
| where InitiatingProcessVersionInfoFileDescription == "The curl executable"
| where InitiatingProcessVersionInfoProductVersion !startswith "8.3.1"
| summarize by TimeGenerated, DeviceName, InitiatingProcessAccountName,RemoteIP,RemotePort,InitiatingProcessVersionInfoProductVersion,InitiatingProcessCommandLine
